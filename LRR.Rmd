---
title: "Log_Response_Ratio"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("tidyverse")
install.packages("ggpubr")
library(tidyverse)
library(ggpubr)
```

```{r}
Monitoring_data <- read.csv(file = "Master_Data.csv")
View(Monitoring_data)
unique(Monitoring_data$Site.Name)
```

```{r}
unique(Monitoring_data$Metric.Groups)
```

```{r}
MD_tidy <- Monitoring_data %>% 
  filter(!Site.Name %in% c("South San Diego Bay", "San Elijo Lagoon", "Zedler Marsh", "Malibu Lagoon")) %>%
  filter(Metric.Groups %in% c("Birds", "Endangered Species", "Fish", "Invertebrates", "Non-native Species", "Vegetation Cover", "Vegetation Species Diveristy")) %>%
  select(Site.Name, Sub.site, Habitat.Type, Year.post.completion, Year, Metrics, Values, Units, Metric.Groups, Metric.Type)
view(MD_tidy)
```

```{r}
San_Deiguito_RR <- MD_tidy %>%
  filter(Site.Name %in% c("San Dieguito", "Tijuana Estuary", "Mugu Lagoon", "Carpinteria Salt Marsh")) %>%
  filter(Year %in% c("2012", "2020")) %>%
  filter(Metrics %in% c("Bird Density", "Bird Species Richness", "Fish Density", "Fish Species Richness", "Macroinvertebrate Density", "Macroinvertebrate Species Richness", "Vegetation Cover")) %>%
  unite(Site.Year, Sub.site, Year) %>%
  filter(Site.Year %in% c("NA_2012", "NA_2020", "Reference Site_2020")) %>%
  separate(Site.Year, c('Sub.Site', 'Year'), sep='_') %>%
  unite(Site.Metric, Site.Name, Metrics) %>%
  filter(!Site.Metric %in% c("Tijuana Estuary_Bird Density", "Mugu Lagoon_Bird Density", "Tijuana Estuary_Bird Species Richness", "Mugu Lagoon_Bird Species Richness", "Tijuana Estuary_Fish Density", "Carpinteria Salt Marsh_Fish Density", "Mugu Lagoon_Fish Species Richness", "Carpinteria Salt Marsh_Fish Species Richness", "Tijuana Estuary_Macroinvertebrate Density", "Mugu Lagoon_Macroinvertebrate Density", "Mugu Lagoon_Macroinvertebrate Species Richness", "Carpinteria Salt Marsh_Macroinvertebrate Species Richness", "Tijuana Estuary_Vegetation Cover", "Mugu Lagoon_Vegetation Cover"))

#view(San_Deiguito_RR)

Degraded_Restored_Reference_SD <- San_Deiguito_RR %>%
  arrange(Year.post.completion, .by_group = FALSE)

SAND_Year1 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "1")
SAND_Year9 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "9")
SAND_Ref <- filter(Degraded_Restored_Reference_SD, Sub.Site == "Reference Site")

SAND_Restored_Values <- SAND_Year9$Values
SAND_Reference_Values <- SAND_Ref$Values
SAND_Year1$SAND_Restored_Values <- SAND_Restored_Values
SAND_Year1$SAND_Reference_Values <- SAND_Reference_Values

SAND_Year1.1 <- SAND_Year1[, c(1,2,3,4,5,7,8,9,6,10,11)]
SAND_Year1.2 <- SAND_Year1.1 %>%
  rename(Degraded.Values = Values, Restored.Values = SAND_Restored_Values, Recent.Reference.Values = SAND_Reference_Values)

SAND_Degraded_Restored_Reference <- SAND_Year1.2 %>%
  separate(Site.Metric, c('Site.Name', 'Metrics'), sep='_') %>%
  select(-Year.post.completion, -Year, -Units)

SAND_Degraded_Restored_Reference_FINAL <- SAND_Degraded_Restored_Reference[, c(1,3,4,2,5,6,7,8,9)]

View(SAND_Degraded_Restored_Reference_FINAL)
```


```{r}
Devereux_Slough_RR <- Monitoring_data %>% 
  filter(Site.Name == "Devereux Slough") %>% 
  filter(Metric.Groups %in% c("Vegetation Cover", "Vegetation Species Diversity", "Vegetation Growth and Health", "Non-native Species", "Birds", "Fish")) %>% 
  filter(Year.post.completion %in% c("1", "4")) %>% 
  filter(Metrics %in% c("Vegetation Cover-Sub Canopy Non-Native", "Vegetation Cover-Sub Canopy Native", "Vegetation Cover-Canopy Native", "Vegetation Cover-Canopy Non-Native", "Vegetation Cover-Native", "Vegetation Cover-Non-Native", "Bird Species Diversity", "Fish Species Diversity", "Individual Count Total", "Species Diversity-Native", "Species Diversity-Non-Native")) %>%
  select(-Habitat.Type.Area..acres., -Date.Details, -Units, -Collection.Method, -Data.Collection.Frequency, -Restoration.Goal.Met...Y.N., -Metric.Significance, -Analyzed.by.who., -Notes) 

Devereux_Slough_RR <- arrange(Devereux_Slough_RR, Year.post.completion, .by_group = FALSE)
DS_Year1 <- filter(Devereux_Slough_RR, Year.post.completion == "1")
DS_Year1 <- DS_Year1[-c(4, 9:10, 13), ]
DS_Year4 <- filter(Devereux_Slough_RR, Year.post.completion == "4")
DS_Year4 <- DS_Year4[-c(4,12,24,32,38), ]
#View(DS_Year4)

Restored_Values <- DS_Year4$Values
DS_Year1$Restored_Values <- Restored_Values

DS_Year1.1 <- DS_Year1[, c(1,2,3,4,5,6,8,9,7,10)]
DS_Degraded_Restored_Reference_FINAL <- DS_Year1.1 %>%
  rename(Degraded.Values = Values, Restored.Values = Restored_Values) %>%
  add_column("Recent.Reference.Values" = NA) %>%
  select(-Year, -Year.post.completion)

View(DS_Degraded_Restored_Reference_FINAL)
```

```{r}
Hallmark_West_RR <- MD_tidy %>%
  filter(Site.Name == "Hallmark West", Values != "NA", Year %in% c("2017", "2020")) %>%
  filter(Metrics %in% c("Average Invertebrate Density - Large Core", "Average Invertebrate Density - Small Core", "Average Native Cover", "Total Vegetation Cover", "Absolute Cover")) %>%
  unite(Sub.site.year, Sub.site, Year.post.completion) %>%
  filter(!Sub.site.year %in% c("Reference Salt Marsh West_1", "Reference Salt Marsh Central_1", "Reference Salt Marsh East_1", "Reference Salt Marsh_1", "Reference Coastal Sage Scrub_1")) %>%
  separate(Sub.site.year, c('Sub.Site', 'Year.post.completion'), sep='_')

#view(Hallmark_West_RR)

Degraded_Restored_HW <- Hallmark_West_RR %>%
  arrange(Year.post.completion, .by_group = FALSE) %>%
  unite(Sub.site.habitat, Sub.Site, Habitat.Type) 

HW_Year1 <- filter(Degraded_Restored_HW, Year.post.completion == "1")
HW_Year4 <- filter(Degraded_Restored_HW, Year.post.completion == "4")



#SAND_Year1 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "1")
#SAND_Year9 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "9")
#SAND_Ref <- filter(Degraded_Restored_Reference_SD, Sub.Site == "Reference Site")


HW_Restored_Values <- HW_Year4$Values
HW_Year1$HW_Restored_Values <- HW_Restored_Values

HW_Year1 <- HW_Year1[, c(1,2,3,4,5,6,8,9,10,7,11)]
names(HW_Year1)[10] <- "Degraded_Values"
HW_Degraded_Restored_FINAL <- HW_Year1 %>%
  select(-Year, -Year.post.completion)

View(HW_Degraded_Restored_FINAL)
```


```{r}
Malibu_Lagoon_RR <- Monitoring_data %>% 
  filter(Site.Name == "Malibu Lagoon") %>% 
  filter(Year.post.completion == "1" | Year.post.completion == "6") %>%
  filter(Metric.Groups == "Fish" | Metric.Groups == "Birds" | Metric.Groups == "Vegetation Cover") %>% 
  arrange(Year.post.completion, .by_group = FALSE) %>%
  slice(-c(7:9, 14:16, 17, 19)) %>%
  select(-Habitat.Type.Area..acres., -Date.Details, -Units, -Collection.Method, -Data.Collection.Frequency, -Restoration.Goal.Met...Y.N., -Metric.Significance, -Analyzed.by.who., -Notes)

ML_Year1 <- filter(Malibu_Lagoon_RR, Year.post.completion == "1")
ML_Year6 <- filter(Malibu_Lagoon_RR, Year.post.completion == "6")

ML_Restored_Values <- ML_Year6$Values
ML_Year1$ML_Restored_Values <- ML_Restored_Values

ML_Year1 <- ML_Year1 %>% 
  add_column("Recent_Reference_Year" = NA)

ML_Year1 <- ML_Year1[, c(1,2,3,4,5,6,8,9,11,7,10)]
names(ML_Year1)[10] <- "Degraded_Values"

ML_Degraded_Restored_FINAL <- ML_Year1 %>%
  select(-Year.post.completion, -Year)

View(ML_Degraded_Restored_FINAL)
```


