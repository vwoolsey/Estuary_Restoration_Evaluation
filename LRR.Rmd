---
title: "Log_Response_Ratio"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("tidyverse")
#install.packages("ggpubr")
```

```{r}
library(tidyverse)
library(ggpubr)
```

```{r}
Monitoring_data <- read.csv(file = "Master_Data.csv")
#View(Monitoring_data)
unique(Monitoring_data$Site.Name)
```

```{r}
unique(Monitoring_data$Metric.Groups)
```

```{r}
MD_tidy <- Monitoring_data %>% 
  filter(!Site.Name %in% c("South San Diego Bay", "San Elijo Lagoon", "Zedler Marsh", "Malibu Lagoon")) %>%
  filter(Metric.Groups %in% c("Birds", "Endangered Species", "Fish", "Invertebrates", "Non-native Species", "Vegetation Cover", "Vegetation Species Diveristy")) %>%
  select(Site.Name, Sub.site, Habitat.Type, Year.post.completion, Year, Metrics, Values, Units, Metric.Groups, Metric.Type)

#view(MD_tidy)
```

```{r}
San_Deiguito_RR <- MD_tidy %>%
  filter(Site.Name %in% c("San Dieguito", "Tijuana Estuary", "Mugu Lagoon", "Carpinteria Salt Marsh")) %>%
  filter(Year %in% c("2012", "2020")) %>%
  filter(Metrics %in% c("Bird Density", "Bird Species Richness", "Fish Density", "Fish Species Richness", "Macroinvertebrate Density", "Macroinvertebrate Species Richness", "Vegetation Cover")) %>%
  unite(Site.Year, Sub.site, Year) %>%
  filter(Site.Year %in% c("NA_2012", "NA_2020", "Reference Site_2020")) %>%
  separate(Site.Year, c('Sub.Site', 'Year'), sep='_') %>%
  unite(Site.Metric, Site.Name, Metrics) %>%
  filter(!Site.Metric %in% c("Tijuana Estuary_Bird Density", "Mugu Lagoon_Bird Density", "Tijuana Estuary_Bird Species Richness", "Mugu Lagoon_Bird Species Richness", "Tijuana Estuary_Fish Density", "Carpinteria Salt Marsh_Fish Density", "Mugu Lagoon_Fish Species Richness", "Carpinteria Salt Marsh_Fish Species Richness", "Tijuana Estuary_Macroinvertebrate Density", "Mugu Lagoon_Macroinvertebrate Density", "Mugu Lagoon_Macroinvertebrate Species Richness", "Carpinteria Salt Marsh_Macroinvertebrate Species Richness", "Tijuana Estuary_Vegetation Cover", "Mugu Lagoon_Vegetation Cover"))

#view(San_Deiguito_RR)

Degraded_Restored_Reference_SD <- San_Deiguito_RR %>%
  arrange(Year.post.completion, .by_group = FALSE)

SAND_Year1 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "1")
SAND_Year9 <- filter(Degraded_Restored_Reference_SD, Year.post.completion == "9")
SAND_Ref <- filter(Degraded_Restored_Reference_SD, Sub.Site == "Reference Site")

SAND_Restored_Values <- SAND_Year9$Values
SAND_Reference_Values <- SAND_Ref$Values
SAND_Year1$SAND_Restored_Values <- SAND_Restored_Values
SAND_Year1$SAND_Reference_Values <- SAND_Reference_Values

SAND_Year1.1 <- SAND_Year1[, c(1,2,3,4,5,7,8,9,6,10,11)]
SAND_Year1.2 <- SAND_Year1.1 %>%
  rename(Degraded.Values = Values, Restored.Values = SAND_Restored_Values, Recent.Reference.Values = SAND_Reference_Values, Sub.site = Sub.Site)

SAND_Degraded_Restored_Reference <- SAND_Year1.2 %>%
  separate(Site.Metric, c('Site.Name', 'Metrics'), sep='_') %>%
  select(-Year.post.completion, -Year, -Units)

SAND_Degraded_Restored_Reference$Degraded.Values <- as.numeric(SAND_Degraded_Restored_Reference$Degraded.Values)
SAND_Degraded_Restored_Reference$Restored.Values <- as.numeric(SAND_Degraded_Restored_Reference$Restored.Values)
SAND_Degraded_Restored_Reference$Recent.Reference.Values <- as.numeric(SAND_Degraded_Restored_Reference$Recent.Reference.Values)

SAND_Degraded_Restored_Reference_FINAL <- SAND_Degraded_Restored_Reference[, c(1,3,4,2,5,6,7,8,9)]

View(SAND_Degraded_Restored_Reference_FINAL)
```


```{r}
Devereux_Slough_RR <- Monitoring_data %>% 
  filter(Site.Name == "Devereux Slough") %>% 
  filter(Metric.Groups %in% c("Vegetation Cover", "Vegetation Species Diversity", "Vegetation Growth and Health", "Non-native Species", "Birds", "Fish")) %>% 
  filter(Year.post.completion %in% c("1", "4")) %>% 
  filter(Metrics %in% c("Vegetation Cover-Sub Canopy Non-Native", "Vegetation Cover-Sub Canopy Native", "Vegetation Cover-Canopy Native", "Vegetation Cover-Canopy Non-Native", "Vegetation Cover-Native", "Vegetation Cover-Non-Native", "Bird Species Diversity", "Fish Species Diversity", "Individual Count Total", "Species Diversity-Native", "Species Diversity-Non-Native")) %>%
  select(-Habitat.Type.Area..acres., -Date.Details, -Units, -Collection.Method, -Data.Collection.Frequency, -Restoration.Goal.Met...Y.N., -Metric.Significance, -Analyzed.by.who., -Notes) 

Devereux_Slough_RR <- arrange(Devereux_Slough_RR, Year.post.completion, .by_group = FALSE)
DS_Year1 <- filter(Devereux_Slough_RR, Year.post.completion == "1")
DS_Year1 <- DS_Year1[-c(4, 9:10, 13), ]
DS_Year4 <- filter(Devereux_Slough_RR, Year.post.completion == "4")
DS_Year4 <- DS_Year4[-c(4,12,24,32,38), ]
#View(DS_Year4)

Restored_Values <- DS_Year4$Values
DS_Year1$Restored_Values <- Restored_Values

DS_Year1.1 <- DS_Year1[, c(1,2,3,4,5,6,8,9,7,10)]

DS_Degraded_Restored_Reference_FINAL <- DS_Year1.1 %>%
  rename(Degraded.Values = Values, Restored.Values = Restored_Values) %>%
  add_column("Recent.Reference.Values" = NA) %>%
  select(-Year, -Year.post.completion)

DS_Degraded_Restored_Reference_FINAL$Degraded.Values <- as.numeric(DS_Degraded_Restored_Reference_FINAL$Degraded.Values)
DS_Degraded_Restored_Reference_FINAL$Restored.Values <- as.numeric(DS_Degraded_Restored_Reference_FINAL$Restored.Values)
DS_Degraded_Restored_Reference_FINAL$Recent.Reference.Values <- as.numeric(DS_Degraded_Restored_Reference_FINAL$Recent.Reference.Values)

View(DS_Degraded_Restored_Reference_FINAL)
```

```{r}
Hallmark_West_RR <- MD_tidy %>%
  filter(Site.Name == "Hallmark West", Values != "NA", Year %in% c("2017", "2020")) %>%
  filter(Metrics %in% c("Average Invertebrate Density - Large Core", "Average Invertebrate Density - Small Core", "Average Native Cover", "Total Vegetation Cover", "Absolute Cover")) %>%
  unite(Sub.site.year, Sub.site, Year.post.completion) %>%
  filter(!Sub.site.year %in% c("Reference Salt Marsh West_1", "Reference Salt Marsh Central_1", "Reference Salt Marsh East_1", "Reference Salt Marsh_1", "Reference Coastal Sage Scrub_1")) %>%
  separate(Sub.site.year, c('Sub.Site', 'Year.post.completion'), sep='_')

#view(Hallmark_West_RR)

Degraded_Restored_HW <- Hallmark_West_RR %>%
  arrange(Year.post.completion, .by_group = FALSE) 

HW_Year1 <- filter(Degraded_Restored_HW, Year.post.completion == "1")
HW_Year4 <- filter(Degraded_Restored_HW, Year.post.completion == "4", !Sub.Site %in% c("Reference Salt Marsh West", "Reference Salt Marsh Central", "Reference Salt Marsh East"))
HW_Ref <- filter(Degraded_Restored_HW, Year.post.completion == "4", Sub.Site %in% c("Reference Salt Marsh West", "Reference Salt Marsh Central", "Reference Salt Marsh East"))

HW_Restored_Values <- HW_Year4$Values
HW_Reference_Values <- HW_Ref$Values
HW_Reference_Values_complete <- c("67.9", "356.5", "162.3", "0", "193.4", "41.4", "", "", "")

HW_Year1$HW_Restored_Values <- HW_Restored_Values
HW_Year1$HW_Reference_Values_complete <- HW_Reference_Values_complete

HW_Year1.1 <- HW_Year1[, c(1,2,3,4,5,6,8,9,10,7,11,12)]

HW_Degraded_Restored__Reference_FINAL <- HW_Year1.1 %>%
  rename(Degraded.Values = Values, Restored.Values = HW_Restored_Values, Recent.Reference.Values = HW_Reference_Values_complete, Sub.site = Sub.Site) %>%
  select(-Year, -Year.post.completion, -Units)

HW_Degraded_Restored__Reference_FINAL$Degraded.Values <- as.numeric(HW_Degraded_Restored__Reference_FINAL$Degraded.Values)
HW_Degraded_Restored__Reference_FINAL$Restored.Values <- as.numeric(HW_Degraded_Restored__Reference_FINAL$Restored.Values)
HW_Degraded_Restored__Reference_FINAL$Recent.Reference.Values <- as.numeric(HW_Degraded_Restored__Reference_FINAL$Recent.Reference.Values)

View(HW_Degraded_Restored__Reference_FINAL)
```


```{r}
Malibu_Lagoon_RR <- Monitoring_data %>% 
  filter(Site.Name == "Malibu Lagoon") %>% 
  filter(Year.post.completion == "1" | Year.post.completion == "6") %>%
  filter(Metric.Groups == "Fish" | Metric.Groups == "Birds" | Metric.Groups == "Vegetation Cover") %>% 
  arrange(Year.post.completion, .by_group = FALSE) %>%
  slice(-c(7:9, 14:16, 17, 19)) %>%
  select(-Habitat.Type.Area..acres., -Date.Details, -Units, -Collection.Method, -Data.Collection.Frequency, -Restoration.Goal.Met...Y.N., -Metric.Significance, -Analyzed.by.who., -Notes)

ML_Year1 <- filter(Malibu_Lagoon_RR, Year.post.completion == "1")
ML_Year6 <- filter(Malibu_Lagoon_RR, Year.post.completion == "6")

ML_Restored_Values <- ML_Year6$Values
ML_Year1$ML_Restored_Values <- ML_Restored_Values

ML_Year1.1 <- ML_Year1 %>% 
  add_column("Recent.Reference.Values" = NA) %>%
  rename(Degraded.Values = Values, Restored.Values = ML_Restored_Values)

ML_Year1.2 <- ML_Year1.1[, c(1,2,3,4,5,6,8,9,7,10,11)]

ML_Degraded_Restored__Reference_FINAL <- ML_Year1.2 %>%
  select(-Year.post.completion, -Year)

#ML_Degraded_Restored__Reference_FINAL$Degraded.Values <- as.numeric(ML_Degraded_Restored__Reference_FINAL$Degraded.Values)
#ML_Degraded_Restored__Reference_FINAL$Restored.Values <- as.numeric(ML_Degraded_Restored__Reference_FINAL$Restored.Values)
#ML_Degraded_Restored__Reference_FINAL$Recent.Reference.Values <- as.numeric(ML_Degraded_Restored__Reference_FINAL$Recent.Reference.Values)

View(ML_Degraded_Restored__Reference_FINAL)
```


```{r}
Point_Mugu_RR <- MD_tidy %>%
  filter(Site.Name == "NBVC Point Mugu", Year %in% c("2017", "2020")) %>%
  arrange(Year.post.completion, .by_group = FALSE) %>%
  unite(Years, Year.post.completion, Year) %>%
  filter(Years != "NA_2017") %>%
  separate(Years, c('Year.post.completion', 'Year'), sep='_')

PM_Year1 <- filter(Point_Mugu_RR, Year.post.completion == "1", Sub.site != "IRP Lower Extension Reference Site A", !Metrics %in% c("Average Total Insects", "Average Insect Diversity", "Total Native Plant Cover", "Total Non-Native Plant Cover", "Total Vegetation Cover"))
PM_Year4 <- filter(Point_Mugu_RR, Year.post.completion == "4",!Metrics %in% c("Number of Nonnative Species (Releve)", "Total Cover (Releve)"))
PM_Ref <- filter(Point_Mugu_RR, Year.post.completion == "NA")


PM_Degraded_Values <- PM_Year1$Values
PM_Degraded_Values[c(7,8,9,10)] <- c("NA", "NA", "NA", "NA")
PM_Restored_Values <- PM_Year4$Values
PM_Reference_Values <- PM_Ref$Values
PM_Reference_Values[9] <- "0"

PM_Year4$PM_Degraded_Values <- PM_Degraded_Values
PM_Year4$PM_Reference_Values <- PM_Reference_Values

PM_Year4.1 <- PM_Year4[, c(1,2,3,4,5,6,8,9,10,11,7,12)]


PM_Degraded_Restored__Reference_FINAL <- PM_Year4.1 %>%
  rename(Restored.Values = Values, Degraded.Values = PM_Degraded_Values, Recent.Reference.Values = PM_Reference_Values) %>%
  select(-Year, -Year.post.completion, -Units)

PM_Degraded_Restored__Reference_FINAL$Degraded.Values <- as.numeric(PM_Degraded_Restored__Reference_FINAL$Degraded.Values)
PM_Degraded_Restored__Reference_FINAL$Restored.Values <- as.numeric(PM_Degraded_Restored__Reference_FINAL$Restored.Values)
PM_Degraded_Restored__Reference_FINAL$Recent.Reference.Values <- as.numeric(PM_Degraded_Restored__Reference_FINAL$Recent.Reference.Values)

View(PM_Degraded_Restored__Reference_FINAL)
```


```{r}
Bolsa_Chica_RR <- MD_tidy %>%
  filter(Site.Name == "Bolsa Chica Lowlands", Year.post.completion %in% c("1", "7"), Values != "NA") %>%
  arrange(Year.post.completion)

BC_Year1 <- filter(Bolsa_Chica_RR, Year.post.completion == "1", Metrics %in% c("# of successful Snowy Plover fledglings ", "Total # of Snowy Plover nests ", "LETE fledgling rate", "Mean LETE clutch size", "# of Belding's Savannah Sparrow territories"))
BC_Year7 <- filter(Bolsa_Chica_RR, Year.post.completion == "7", Metrics %in% c("Total # of successful Snowy Plover fledglings", "Total # of Snowy Plover nests", "LETE fledgling rate", "Mean LETE clutch size", "# of Belding's Savannah Sparrow territories"))

BC_Degraded_Values <- BC_Year1$Values
BC_Restored_Values <- BC_Year7$Value
BC_Restored_Values[3] <- "0.325"

BC_Year1$BC_Restored_Values <- BC_Restored_Values

BC_Year1.1 <- BC_Year1 %>%
  add_column("Recent.Reference.Values" = NA) %>%
  rename(Restored.Values = BC_Restored_Values, Degraded.Values = Values) %>%
  select(-Year, -Year.post.completion, -Units)

BC_Degraded_Restored__Reference_FINAL <- BC_Year1.1[, c(1,2,3,4,6,7,5,8,9)]

BC_Degraded_Restored__Reference_FINAL$Degraded.Values <- as.numeric(BC_Degraded_Restored__Reference_FINAL$Degraded.Values)
BC_Degraded_Restored__Reference_FINAL$Restored.Values <- as.numeric(BC_Degraded_Restored__Reference_FINAL$Restored.Values)
BC_Degraded_Restored__Reference_FINAL$Recent.Reference.Values <- as.numeric(BC_Degraded_Restored__Reference_FINAL$Recent.Reference.Values)

view(BC_Degraded_Restored__Reference_FINAL)
```


```{r}
LRR_ALL_SITES <- rbind(SAND_Degraded_Restored_Reference_FINAL, DS_Degraded_Restored_Reference_FINAL, HW_Degraded_Restored__Reference_FINAL, ML_Degraded_Restored__Reference_FINAL, PM_Degraded_Restored__Reference_FINAL, BC_Degraded_Restored__Reference_FINAL)

view(LRR_ALL_SITES)
```

